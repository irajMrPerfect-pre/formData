<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="fragment" content="!" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" >
    <title> @Raj Kumar Dubey Form Example</title>
    <!-- Latest compiled and minified CSS -->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->

    <!-- jQuery library -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->

    <!-- Latest compiled JavaScript -->
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <script src="underscore.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.16/angular.min.js"></script>

    <style type="text/css">

        .inside-form-div{
            border: 1px solid;
            padding: 10px 0;
            text-align: center;
            background: skyblue;
        }

        form{
                width: 430px;
                border: 1px solid #4e4e4e;
                padding: 10px 57px;
                margin: 30px 0;
                background: aliceblue;
        }

        input{
            -moz-transition: all 0.3s;
            -o-transition: all 0.3s;
            -webkit-transition: all 0.3s;
            transition: all 0.3s;
            padding: 10px 15px;
            margin-left: 15px;
        }

        select{
            -moz-transition: all 0.3s;
            -o-transition: all 0.3s;
            -webkit-transition: all 0.3s;
            transition: all 0.3s;
            padding: 10px 15px;
        }

        label{
            font-size: 17px;
            font-weight: 500px;
        }

        .formcontainer{
            width: 90%;
        }

        div{
            margin: 15px auto!important;
        }
        li {
            list-style: none outside none;
        }
        td{
          vertical-align:middle;
          border: 1px solid;
          width: 16.6px;

        }
        th{
          /*color:lightblue;*/
          width: 16.6px;
        }
        table{
            width: 100%;
            border: 1px solid;
            margin: 0 auto;
            text-align: center;

        }
    </style>
</head>
<body ng-app="squirrelApp">  
    <h1>Squirrel Information:</h1>
    <div class="formcontainer" ng-controller="squirrelController">
        <table ng-if="squirrelData.length>0">
            <th>Name</th>
            <th>D.O.B</th>
            <th>Contact No </th>
            <th>E-mail ID</th>
            <th>Gender</th>
            <th>Action <a style="display: block;">Update/Remove</a></th>
            <tr ng-repeat="data in squirrelData | orderBy:'data.id'">
                <td>{{data.name}}</td>
                <td>{{data.DoB | date:'dd/MM/yyyy'}}</td>
                <td>{{data.contact}}</td>
                <td>{{data.email}}</td>
                <td>{{data.gender}}</td>
                <td><button ng-click="updateData($index)" >Update</button> <button ng-click="squirrelData.splice($index,1)">Remove</button></a></td>
            </tr>
        </table>
        <form ng-submit="submitsquirrelForm()" >
                <div class="inside-form-div">
                    <label for="name" > Name </label>
                    <input placeholder="Name" type="text" id="name" ng-model="squirrel.name" required/>
                </div>

                <div class="inside-form-div">
                    <label for="contact" > Contact </label>
                    <input placeholder="Your Phone Number" type="tel" maxlength="10" id="contact" ng-model="squirrel.contact" required />
                </div>

                <div class="inside-form-div">
                    <span>Gender:</span>
                    <label><input value="male" type="radio" name="training" ng-model="squirrel.gender" />Male</label>
                    <label><input value="female" type="radio" name="training" ng-model="squirrel.gender" />Female</label> 
                </div>

                <div class="inside-form-div">
                    <label for="dob" >DoB</label>
                    <input type="date" id="dob" ng-model="squirrel.DoB" required/> 
                </div>

                <div class="inside-form-div">
                    <label for="email"> Email </label>
                    <input type="email" name="email" id="email" ng-model="squirrel.email" placeholder="email" required/>                
                </div>

                <div class="inside-form-div">
                    <label for="education">Education</label>
                    <select name="education" ng-model="squirrel.education">
                      <option value="">---Please select---</`option>
                      <option value="10th">10th</option> 
                      <option value="12th">12th</option>
                      <option value="graduate">Graduate</option>
                    </select>
                </div>

                <div class="inside-form-div">
                    <span> Hobbies </span>
                    <label><input type="checkbox" ng-model="squirrel.cricket" />Cricket</label> 
                    <label><input type="checkbox" ng-model="squirrel.chess" />Chess</label> 
                    <label><input type="checkbox" ng-model="squirrel.foot_ball" />Foot Ball</label> 
                    <label><input type="checkbox"  ng-model="squirrel.reading" />Reading</label>
                </div>
                <div class="inside-form-div">
                    <input type="submit" value="Submit" /> 
                </div>
        </form>
    </div>
    <h2>Squirrel Search:</h2>
    <div  class="formcontainer" ng-controller="squirrelController">
        <form ng-submit="searchSquirrelForm()" >
                <div class="inside-form-div">
                    <label for="gender">Gender</label>
                    <select name="gender" ng-model="squirrelSearch.gender">
                      <option value="">---Please select---</option>
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                    </select>
                </div>

                <div class="inside-form-div">
                    <span> Hobbies </span>
                    <label><input type="checkbox" ng-model="squirrelSearch.cricket" />Cricket</label> 
                    <label><input type="checkbox" ng-model="squirrelSearch.chess" />Chess</label> 
                    <label><input type="checkbox" ng-model="squirrelSearch.foot_ball" />Foot Ball</label> 
                    <label><input type="checkbox"  ng-model="squirrelSearch.reading" />Reading</label>
                </div>

                <div class="inside-form-div">
                    <span>Education:</span>
                    <label><input value="10th" type="radio" name="education" ng-model="squirrelSearch.education" />10th</label>
                    <label><input value="12th" type="radio" name="education" ng-model="squirrelSearch.education" />12th</label> 
                    <label><input value="graduate" type="radio" name="education" ng-model="squirrelSearch.education" />Graduate</label>  
                </div>  

                <div class="inside-form-div">
                    <label for="squirrelSearchBirth">Birth</label>
                    <select name="birth" ng-model="squirrelSearchBirth">
                      <option value="">---Please select---</option>
                      <option value="{{month}}" ng-repeat="month in listofMonths">{{month}}</option>
                    </select>
                </div>
                <div class="inside-form-div">
                    <input type="submit" value="Search" /> 
                </div>
        </form>

        <div ng-if="filterData.length>0">
            <h2>Filtered Data</h2>
        </div>
        <div ng-if="filterData.length == 0 && userSearchQuery == 1" style="text-align: center;">
            <h4>No Result found</h4>
        </div>
        <table ng-if="filterData.length>0">
            <th>Name</th>
            <th>Contact No </th>
            <th>E-mail</th>
            <tr ng-repeat="data in filterData | limitTo : 5">
                <td>{{data.name}}</td>
                <td>{{data.contact}}</td>
                <td>{{data.email}}</td>
            </tr>
        </table>
    </div>
    <script>
        //1. create app module 
        var squirrelApp = angular.module('squirrelApp', []);

        //2. create controller
        squirrelApp.controller("squirrelController", function ($scope, $http, $rootScope) {
  
            $scope.listofMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

            $rootScope.squirrelData = [] ;

            $scope.originalsquirrel = {
                id:0,
                name: "",
                DoB: "",
                gender: "",
                email : "",
                contact : "",
                education:"",
                cricket: false,
                chess: false,
                reading: false,
                foot_ball: false
            };

            //4. copy originalsquirrel to squirrel. squirrel will be bind to a form 
            $scope.squirrel = angular.copy($scope.originalsquirrel);

            //5. create submitsquirrelForm() function. This will be called when user submits the form
            $scope.submitsquirrelForm = function () {              
                
                var found = $rootScope.squirrelData.some(function (el) {
                    return el.id === $scope.squirrel.id;
                });
                
                if (!found) {
                    $scope.squirrel.id = $rootScope.squirrelData.length + 1;
                    $rootScope.squirrelData.push($scope.squirrel);
                    $scope.resetForm();
                }

                else{
                    $rootScope.squirrelData.splice($scope.updateIndex,1)
                    $rootScope.squirrelData.push($scope.squirrel);
                    $scope.resetForm();
                }
            };

            //6. create resetForm() function. This will be called on Reset button click.  
            $scope.resetForm = function () {
                $scope.squirrel = angular.copy($scope.Originalsquirrel);
            };

            //7. create updateData() function. This will be called on update button click.
            $scope.updateData = function(index){
                $scope.tempArray = $rootScope.squirrelData[index];
                $scope.squirrel = angular.copy($scope.tempArray);
                $scope.updateIndex = index;
            }

            $scope.originalsquirrelSearch = { };

            $scope.userSearchQuery = 0;

            $scope.squirrelSearch = angular.copy($scope.originalsquirrelSearch);

            $scope.squirrelQueryData = angular.copy($rootScope.squirrelData);

            $scope.squirrelSearchData = [] ;

            //8. create searchSquirrelForm() function. This will be called when user click on search 
            $scope.searchSquirrelForm = function () { 
                $scope.squirrelQueryData = angular.copy($rootScope.squirrelData);
                $scope.filterData = _.where ($scope.squirrelQueryData, $scope.squirrelSearch);             
                var i=0
                while(i < $scope.filterData.length){
                    if (($scope.squirrelSearchBirth!= undefined) && ($scope.squirrelSearchBirth != $scope.listofMonths[$scope.filterData[i].DoB.getMonth()])){
                        $scope.filterData.splice(i,1)
                    }
                    i++
                };
                $scope.userSearchQuery = 1;
                $scope.squirrelSearch = angular.copy($scope.originalsquirrelSearch);

            };
    });
    </script>    
</body>
</html>